<script setup>
definePageMeta({
  layout: "customer",
  middleware:'auth'
});
import useWalletBalance from "~/composables/wallet/useWalletBalance.js";
const {$intercept} = useNuxtApp()
const localePath = useLocalePath()

const apiWithdrawRequest = (data) => $intercept(`wallet/withdrawal-requests/`, {
  method: "POST",
  body: JSON.stringify(data)

})

const {mutate, isPending} = useMutate({
  mutationFn: apiWithdrawRequest,
});

const visibleWithdrawModel = ref(false)

function sendWithdrawAmount(data) {
  mutate(data.value, {
    onSuccess(){
      visibleWithdrawModel.value = false
      setTimeout(()=>{
        navigateTo(localePath('/add-balance'));
      },2000)
    },
  });
}



const {walletBalance, pending} = await useWalletBalance();
</script>

<template>
  <Dialog v-model:visible="visibleWithdrawModel" :draggable="false" :closable="false" :breakpoints="{'960px': '75vw', '640px': '100vh'}" :style="{width: '1115px'}" :modal="true" >
    <ModelsWalletWithdrawAmountModel
        :walletAmount="walletBalance.balance"
        @sendWithdrawAmount="sendWithdrawAmount"
        :loading="isPending"
        @close="visibleWithdrawModel = false"
    />
  </Dialog>

  <div class="container my-[40px]">
    <UIBox class="mb-2">
      <div class="flex flex-col items-center justify-center gap-[12px] w-full mb-[8px]">
        <p class="text-2xl font-medium">Current Salary</p>
        <span class="font-medium text-xl">{{walletBalance.balance}} USD</span>
      </div>
      <div class="grid md:grid-cols-1 grid-cols-1 w-full gap-[32px]  mt-[40px]">
        <button class="flex items-center justify-center gap-4 text-white  bg-red-500 py-[22px] rounded-[8px] disabled:cursor-not-allowed disabled:opacity-30 disabled:bg-primary-600  disabled:text-gray-750 disabled:border-gray-750 group"
                :disabled="!walletBalance?.balance"
                @click="visibleWithdrawModel = true">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="none">
            <path class="group-disabled:fill-gray-750" d="M30.4885 4.87376V11.9198C30.4885 12.8918 29.6975 13.6948 28.7194 13.6948H26.6484C27.6265 13.6948 28.4175 12.8918 28.4175 11.9198V4.87376C28.4175 3.90162 27.6265 3.10468 26.6484 3.10468H28.7194C29.6975 3.10468 30.4885 3.90162 30.4885 4.87376Z" fill="#ffffff"/>
            <path class="group-disabled:fill-gray-750"  d="M28.7183 13.9966H26.6476C26.4807 13.9966 26.3457 13.8616 26.3457 13.6947C26.3457 13.5279 26.4807 13.3928 26.6476 13.3928C27.4566 13.3928 28.1146 12.7319 28.1146 11.9197V4.87367C28.1146 4.06471 27.4566 3.40669 26.6476 3.40669C26.4807 3.40669 26.3457 3.27167 26.3457 3.1048C26.3457 2.93794 26.4807 2.80292 26.6476 2.80292H28.7183C29.8604 2.80292 30.7897 3.73187 30.7897 4.87367V11.9197C30.7897 13.065 29.8604 13.9966 28.7183 13.9966ZM28.1057 13.3928H28.7183C29.5273 13.3928 30.1859 12.7319 30.1859 11.9197V4.87367C30.1859 4.06471 29.5273 3.40669 28.7183 3.40669H28.1075C28.4849 3.78199 28.7183 4.30115 28.7183 4.87367V11.9197C28.7183 12.4948 28.4837 13.0164 28.1057 13.3928Z" fill="#ffffff"/>
            <path class="group-disabled:fill-gray-750"  d="M26.6478 13.9966H22.8684C22.7015 13.9966 22.5665 13.8616 22.5665 13.6947V8.7015H7.35127V13.6947C7.35127 13.8616 7.21624 13.9966 7.04938 13.9966H3.2758C2.13723 13.9966 1.21094 13.065 1.21094 11.9197V4.87367C1.21094 3.73187 2.13723 2.80292 3.2758 2.80292H26.6478C27.7899 2.80292 28.7186 3.73187 28.7186 4.87367V11.9197C28.7186 13.065 27.7899 13.9966 26.6478 13.9966ZM23.1703 13.3928H26.6478C27.4568 13.3928 28.1148 12.7319 28.1148 11.9197V4.87367C28.1148 4.06471 27.4568 3.40669 26.6478 3.40669H3.2758C2.47037 3.40669 1.81471 4.06471 1.81471 4.87367V11.9197C1.81471 12.7319 2.47037 13.3928 3.2758 13.3928H6.74749V8.39962C6.74749 8.23275 6.88252 8.09773 7.04938 8.09773H22.8684C23.0352 8.09773 23.1703 8.23275 23.1703 8.39962V13.3928Z" fill="#ffffff"/>
            <path class="group-disabled:fill-gray-750"  d="M25.1928 10.8268H22.8685C22.7016 10.8268 22.5666 10.6918 22.5666 10.5249V8.70149H7.35138V10.5249C7.35138 10.6918 7.21635 10.8268 7.04949 10.8268H4.73699C4.14442 10.8268 3.66211 10.3448 3.66211 9.7522V7.0473C3.66211 6.45473 4.14442 5.97272 4.73699 5.97272H25.1928C25.7853 5.97272 26.2677 6.45473 26.2677 7.0473V9.7522C26.2677 10.3448 25.7853 10.8268 25.1928 10.8268ZM23.1704 10.223H25.1928C25.4528 10.223 25.6639 10.0119 25.6639 9.7522V7.0473C25.6639 6.78758 25.4528 6.57649 25.1928 6.57649H4.73699C4.47697 6.57649 4.26588 6.78758 4.26588 7.0473V9.7522C4.26588 10.0119 4.47697 10.223 4.73699 10.223H6.7476V8.3996C6.7476 8.23274 6.88263 8.09772 7.04949 8.09772H22.8685C23.0353 8.09772 23.1704 8.23274 23.1704 8.3996V10.223Z" fill="#ffffff"/>
            <path  class="group-disabled:fill-gray-750" d="M23.9636 8.69856H5.96595C5.79909 8.69856 5.66406 8.56354 5.66406 8.39667C5.66406 8.22981 5.79909 8.09479 5.96595 8.09479H23.9636C24.1305 8.09479 24.2655 8.22981 24.2655 8.39667C24.2655 8.56354 24.1305 8.69856 23.9636 8.69856Z" fill="#ffffff"/>
            <path class="group-disabled:fill-gray-750"  d="M9.1875 28.8722C7.84729 28.8722 6.75649 27.7817 6.75649 26.4412L6.75 8.39695C6.75 8.31706 6.78184 8.24011 6.83844 8.18351C6.89505 8.1269 6.9717 8.09506 7.05189 8.09506H22.8715C23.0383 8.09506 23.1733 8.23009 23.1733 8.39695L23.1792 26.435C23.1792 27.7755 22.0884 28.8663 20.7482 28.8663L9.1875 28.8722ZM7.35377 8.69884L7.36026 26.4412C7.36026 27.4488 8.17983 28.2684 9.1875 28.2684L20.7482 28.2625C21.7559 28.2625 22.5755 27.4426 22.5755 26.435L22.5696 8.69884H7.35377Z" fill="#ffffff"/>
            <path class="group-disabled:fill-gray-750"  d="M18.6059 10.6685C18.067 10.6685 17.6289 10.2301 17.6289 9.69147V8.39695C17.6289 8.23009 17.7639 8.09506 17.9308 8.09506H19.281C19.4479 8.09506 19.5829 8.23009 19.5829 8.39695V9.69147C19.5829 10.2301 19.1448 10.6685 18.6059 10.6685ZM18.2327 8.69884V9.69147C18.2327 9.90078 18.3966 10.0647 18.6059 10.0647C18.8117 10.0647 18.9791 9.89724 18.9791 9.69147V8.69884H18.2327Z" fill="#ffffff"/>
            <path  class="group-disabled:fill-gray-750" d="M19.7958 26.8168H10.1372C10.057 26.8168 9.9804 26.7849 9.92379 26.7283L8.89903 25.7036C8.84242 25.6469 8.81058 25.5703 8.81058 25.4901L8.80469 8.39695C8.80469 8.31706 8.83653 8.24011 8.89313 8.18351C8.94973 8.1269 9.02639 8.09506 9.10657 8.09506H20.8141C20.981 8.09506 21.116 8.23009 21.116 8.39695L21.1225 25.4839C21.1225 25.5632 21.0912 25.6393 21.0358 25.6959C20.6473 26.0898 20.4214 26.3156 20.0435 26.6944C19.9863 26.751 19.876 26.8168 19.7958 26.8168ZM10.2622 26.213H19.6708C19.9981 25.8855 20.2098 25.6735 20.5187 25.3601L20.5122 8.69884H9.40846L9.41436 25.3651L10.2622 26.213Z" fill="#ffffff"/>
            <path class="group-disabled:fill-gray-750"  d="M14.9638 20.9721C12.419 20.9721 10.3482 18.9017 10.3477 16.3566C10.3477 13.8112 12.4184 11.7401 14.9632 11.7398C16.1961 11.7398 17.3559 12.2198 18.2274 13.0915C19.0994 13.9633 19.58 15.1225 19.58 16.3554C19.5806 17.5883 19.1 18.7475 18.2286 19.6196C17.3565 20.4916 16.1967 20.9719 14.9638 20.9721ZM14.9638 12.3436C12.7515 12.3439 10.9514 14.144 10.9514 16.3566C10.952 18.5686 12.7521 20.3681 14.9638 20.3684C16.0358 20.3684 17.0434 19.9506 17.8017 19.1927C18.5593 18.4347 18.9762 17.427 18.9762 16.3554C18.9762 15.2838 18.5587 14.2761 17.8005 13.5184C17.0428 12.7608 16.0352 12.3436 14.9638 12.3436Z" fill="#ffffff"/>
            <path class="group-disabled:fill-gray-750"  d="M11.3229 25.2767C10.7857 25.2767 10.3482 24.8395 10.3482 24.3023L10.3477 22.4143C10.3477 21.8775 10.7846 21.44 11.3223 21.4397C11.8594 21.4397 12.2969 21.8769 12.2969 22.414V24.302C12.2975 24.5609 12.1961 24.8056 12.0116 24.9901C11.827 25.175 11.5829 25.2767 11.3229 25.2767ZM11.3223 22.0435C11.1177 22.0438 10.9514 22.21 10.9514 22.4143L10.952 24.3023C10.952 24.5066 11.1183 24.6729 11.3229 24.6729C11.4214 24.6729 11.5139 24.634 11.5847 24.5635C11.6548 24.4931 11.6932 24.4005 11.6932 24.3026V22.414C11.6932 22.2097 11.5269 22.0435 11.3223 22.0435Z" fill="#ffffff"/>
            <path  class="group-disabled:fill-gray-750" d="M17.3119 16.2144C17.3057 15.8156 17.183 15.4965 16.9375 15.2756C16.6921 15.0547 16.416 14.938 16.1092 14.938C15.7716 14.938 15.5017 15.0424 15.3114 15.251C15.1212 15.4597 14.9801 15.7788 14.9003 16.2083H13.2619C13.2865 15.8708 13.4153 15.6437 13.6424 15.521C13.7712 15.4474 13.9676 15.4044 14.2437 15.386V14.8583C13.9001 14.8583 13.6239 14.9135 13.4215 15.0301C13.0472 15.2387 12.8385 15.6314 12.8017 16.2144H12.2188V16.5028H12.8017C12.8447 16.8648 12.9244 17.141 13.0472 17.3373C13.2742 17.6809 13.6547 17.8528 14.1885 17.8528C14.5567 17.8528 14.8328 17.7178 15.023 17.4478C15.1396 17.2821 15.2624 16.9692 15.3912 16.5028H16.8516C16.8455 16.7789 16.735 16.9815 16.5326 17.1042C16.4221 17.1717 16.2932 17.2146 16.1398 17.2269V17.7546C16.4835 17.7485 16.7535 17.6319 16.9621 17.4233C17.1707 17.2084 17.2873 16.9016 17.318 16.5028H17.7107V16.2144H17.3119ZM14.6119 17.0367C14.483 17.2207 14.2928 17.3128 14.0412 17.3128C13.8817 17.3128 13.7405 17.2821 13.6239 17.2146C13.3847 17.0796 13.2619 16.8465 13.2435 16.5028H14.8267C14.7592 16.7544 14.6855 16.9323 14.6119 17.0367ZM15.4464 16.2083C15.4894 15.9873 15.5692 15.8094 15.6796 15.6805C15.7962 15.5455 15.9496 15.4842 16.146 15.4842C16.3116 15.4842 16.4712 15.5394 16.6185 15.6499C16.7719 15.7604 16.8516 15.9444 16.8639 16.2083H15.4464Z" fill="#ffffff"/>
            <path  class="group-disabled:fill-gray-750" d="M4.07031 29.1971C3.99012 29.1971 3.91347 29.1653 3.85687 29.1087L2.69001 27.9421C2.57208 27.8242 2.57208 27.6331 2.69001 27.5152C2.80793 27.3973 2.99897 27.3973 3.11689 27.5152L4.07031 28.4683L5.02314 27.5152C5.14107 27.3973 5.3321 27.3973 5.45003 27.5152C5.56795 27.6331 5.56795 27.8242 5.45003 27.9421L4.28376 29.1087C4.22715 29.1653 4.1505 29.1971 4.07031 29.1971Z" fill="#ffffff"/>
            <path  class="group-disabled:fill-gray-750" d="M4.06946 29.0806C3.9026 29.0806 3.76758 28.9456 3.76758 28.7788V25.0296C3.76758 24.8628 3.9026 24.7278 4.06946 24.7278C4.23633 24.7278 4.37135 24.8628 4.37135 25.0296V28.7788C4.37135 28.9456 4.23633 29.0806 4.06946 29.0806Z" fill="#ffffff"/>
            <path  class="group-disabled:fill-gray-750" d="M25.8555 22.4046C25.7753 22.4046 25.6986 22.3728 25.642 22.3162L24.4752 21.1496C24.3572 21.0317 24.3572 20.8407 24.4752 20.7228C24.5931 20.6048 24.7841 20.6048 24.902 20.7228L25.8555 21.6759L26.8083 20.7228C26.9262 20.6048 27.1173 20.6048 27.2352 20.7228C27.3531 20.8407 27.3531 21.0317 27.2352 21.1496L26.0689 22.3162C26.0123 22.3728 25.9357 22.4046 25.8555 22.4046Z" fill="#ffffff"/>
            <path  class="group-disabled:fill-gray-750" d="M25.8546 22.2882C25.6878 22.2882 25.5527 22.1532 25.5527 21.9863V18.2372C25.5527 18.0703 25.6878 17.9353 25.8546 17.9353C26.0215 17.9353 26.1565 18.0703 26.1565 18.2372V21.9863C26.1565 22.1532 26.0215 22.2882 25.8546 22.2882Z" fill="#ffffff"/>
          </svg>
          <p class="text-[20px] font-normal">{{$t('withdraw')}}</p>
        </button>

      </div>
    </UIBox>
  </div>
</template>

<style scoped>

</style>